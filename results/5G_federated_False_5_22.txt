
cf matrix for slice :5
[[3915   12    0    0    0]
 [  19 3730    0    0    0]
 [1158    0    0    0    0]
 [ 607    0    0    0    0]
 [   2  163    0    0    0]]
cf matrix for slice :5
[[3912    0   15    0    0]
 [3749    0    0    0    0]
 [   0    0 1158    0    0]
 [ 212    0  395    0    0]
 [ 165    0    0    0    0]]
cf matrix for slice :5
[[3915    0    0   12    0]
 [3749    0    0    0    0]
 [ 446    0    0  712    0]
 [   3    0    0  604    0]
 [ 165    0    0    0    0]]
cf matrix for slice :5
[[3927    0    0    0    0]
 [3749    0    0    0    0]
 [1158    0    0    0    0]
 [ 607    0    0    0    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3927    0    0    0    0]
 [3749    0    0    0    0]
 [1158    0    0    0    0]
 [ 607    0    0    0    0]
 [ 165    0    0    0    0]]
Centralized Mean train accuracy: 0.9965427125558606
Centralized Mean test accuracy: 0.5245138455132211
before training main model
cf matrix for slice :5
[[  12   42    0 3872    1]
 [   0    0    0 3749    0]
 [ 615   24    0  518    1]
 [ 139  209    0  259    0]
 [   1    0    0  164    0]]
after training main model
cf matrix for slice :5
[[3927    0    0    0    0]
 [3749    0    0    0    0]
 [1158    0    0    0    0]
 [ 607    0    0    0    0]
 [ 165    0    0    0    0]]
Before training federated
     sample  local_ind_model  merged_main_model
0  sample 0           0.7956             0.0282
1  sample 1           0.5279             0.0282
2  sample 2           0.4699             0.0282
3  sample 3           0.4260             0.0282
4  sample 4           0.4088             0.0282
After training federated
     sample  local_ind_model  merged_main_model
0  sample 0           0.7956             0.4088
1  sample 1           0.5279             0.4088
2  sample 2           0.4699             0.4088
3  sample 3           0.4260             0.4088
4  sample 4           0.4088             0.4088
cf matrix for slice :5
[[3924    0    3    0    0]
 [3749    0    0    0    0]
 [ 572    0  586    0    0]
 [ 246    0  361    0    0]
 [ 165    0    0    0    0]]
cf matrix for slice :5
[[3927    0    0    0    0]
 [3749    0    0    0    0]
 [1158    0    0    0    0]
 [ 607    0    0    0    0]
 [ 165    0    0    0    0]]
cf matrix for slice :5
[[3927    0    0    0    0]
 [3749    0    0    0    0]
 [ 941    0  216    1    0]
 [ 468    0  124   15    0]
 [ 148   17    0    0    0]]
cf matrix for slice :5
[[3927    0    0    0    0]
 [3529  220    0    0    0]
 [1151    0    6    1    0]
 [ 569    0   11   27    0]
 [ 157    8    0    0    0]]
cf matrix for slice :5
[[3927    0    0    0    0]
 [3016  733    0    0    0]
 [ 911    0  244    3    0]
 [ 444    0   66   97    0]
 [  23  142    0    0    0]]
cf matrix for slice :5
[[3927    0    0    0    0]
 [2344 1405    0    0    0]
 [ 802    0  311   45    0]
 [ 327    0   36  244    0]
 [  13  152    0    0    0]]
cf matrix for slice :5
[[3927    0    0    0    0]
 [2603 1146    0    0    0]
 [ 796    0  312   50    0]
 [ 319    0   23  265    0]
 [   7  105    0    0   53]]
cf matrix for slice :5
[[3927    0    0    0    0]
 [2274 1475    0    0    0]
 [ 804    0  322   32    0]
 [ 371    0   20  216    0]
 [   5   68    0    0   92]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [2101 1648    0    0    0]
 [ 434    0  692   32    0]
 [ 260    0   57  290    0]
 [   7    0    0    0  158]]
cf matrix for slice :5
[[3927    0    0    0    0]
 [1196 2553    0    0    0]
 [ 765    0  354   39    0]
 [ 320    0   19  268    0]
 [   5   14    0    0  146]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [1629 2120    0    0    0]
 [ 398    0  713   47    0]
 [ 265    0   31  311    0]
 [   2    6    0    0  157]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [1321 2428    0    0    0]
 [ 432    0  663   63    0]
 [ 239    0   18  350    0]
 [   2    4    0    0  159]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [1605 2144    0    0    0]
 [ 357    0  744   57    0]
 [ 274    0   23  310    0]
 [   2    0    0    0  163]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [1141 2608    0    0    0]
 [ 423    0  681   54    0]
 [ 145    0   21  441    0]
 [   2    0    0    0  163]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [1027 2722    0    0    0]
 [ 299    0  785   74    0]
 [ 196    0   10  401    0]
 [   1    0    0    0  164]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [1264 2485    0    0    0]
 [ 349    0  738   71    0]
 [ 128    0   12  467    0]
 [   1    0    0    0  164]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [1064 2685    0    0    0]
 [ 265    0  822   71    0]
 [ 192    0   13  402    0]
 [   1    0    0    0  164]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 924 2825    0    0    0]
 [ 315    0  785   58    0]
 [ 119    0   18  470    0]
 [   1    0    0    0  164]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [1280 2469    0    0    0]
 [ 270    0  822   66    0]
 [ 172    0   21  414    0]
 [   1    0    0    0  164]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [1030 2719    0    0    0]
 [ 315    0  770   73    0]
 [ 158    0   11  438    0]
 [   1    0    0    0  164]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 499 3250    0    0    0]
 [ 181    0  924   53    0]
 [ 149    0   30  428    0]
 [   1    0    0    0  164]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 639 3110    0    0    0]
 [ 231    0  859   68    0]
 [ 105    0   17  485    0]
 [   1    0    0    0  164]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 979 2770    0    0    0]
 [ 166    0  933   59    0]
 [  93    0   21  493    0]
 [   1    0    0    0  164]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 398 3351    0    0    0]
 [ 166    0  921   71    0]
 [  66    0   13  528    0]
 [   1    0    0    0  164]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [1096 2653    0    0    0]
 [ 206    0  883   69    0]
 [  79    0   13  515    0]
 [   1    0    0    0  164]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 484 3265    0    0    0]
 [ 141    0  928   89    0]
 [  63    0   10  534    0]
 [   1    0    0    0  164]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [1033 2716    0    0    0]
 [ 176    0  921   61    0]
 [  81    0   20  506    0]
 [   1    0    0    0  164]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 444 3305    0    0    0]
 [ 127    0  955   76    0]
 [  63    0   16  528    0]
 [   1    0    0    0  164]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 941 2808    0    0    0]
 [ 156    0  932   70    0]
 [  64    0   17  526    0]
 [   1    0    0    0  164]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 315 3434    0    0    0]
 [ 120    0  988   50    0]
 [  59    0   23  525    0]
 [   1    0    0    0  164]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 790 2959    0    0    0]
 [ 188    0  903   67    0]
 [  84    0   15  508    0]
 [   1    0    0    0  164]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 142 3607    0    0    0]
 [ 157    0  922   79    0]
 [  72    0   10  525    0]
 [   1    0    0    0  164]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 867 2882    0    0    0]
 [ 160    0  939   59    0]
 [  84    0   15  508    0]
 [   1    0    0    0  164]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 194 3555    0    0    0]
 [  68    0 1010   80    0]
 [  45    0   15  547    0]
 [   1    0    0    0  164]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [1237 2512    0    0    0]
 [  97    0  996   65    0]
 [  57    0   17  533    0]
 [   1    0    0    0  164]]
cf matrix for slice :5
[[3922    4    0    1    0]
 [  63 3686    0    0    0]
 [  36    0  992  130    0]
 [  21    0    9  577    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 912 2837    0    0    0]
 [ 116    0  992   50    0]
 [  57    0   22  528    0]
 [   1    0    0    0  164]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 360 3389    0    0    0]
 [  45    0 1021   92    0]
 [  36    0   13  558    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [1005 2744    0    0    0]
 [  85    0 1005   68    0]
 [  49    0   17  541    0]
 [   1    0    0    0  164]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 174 3575    0    0    0]
 [  78    0 1010   70    0]
 [  42    0   17  548    0]
 [   1    0    0    0  164]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [1147 2602    0    0    0]
 [  80    0 1006   72    0]
 [  38    0   17  552    0]
 [   1    0    0    0  164]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 154 3595    0    0    0]
 [  65    0 1017   76    0]
 [  39    0   16  552    0]
 [   1    0    0    0  164]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 962 2787    0    0    0]
 [  78    0 1021   59    0]
 [  49    0   17  541    0]
 [   1    0    0    0  164]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 140 3609    0    0    0]
 [ 109    0  998   51    0]
 [  65    0   23  519    0]
 [   1    0    0    0  164]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 927 2822    0    0    0]
 [  73    0 1033   52    0]
 [  50    0   25  532    0]
 [   1    0    0    0  164]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 283 3466    0    0    0]
 [  76    0 1032   50    0]
 [  47    0   21  539    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 782 2967    0    0    0]
 [  51    0 1050   57    0]
 [  38    0   21  548    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 327 3422    0    0    0]
 [  71    0 1008   79    0]
 [  33    0   16  558    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 688 3061    0    0    0]
 [  86    0  997   75    0]
 [  45    0   16  546    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 245 3504    0    0    0]
 [  95    0  982   81    0]
 [  51    0   16  540    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 842 2907    0    0    0]
 [  68    0 1013   77    0]
 [  44    0   17  546    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 156 3593    0    0    0]
 [  62    0 1006   90    0]
 [  35    0   15  557    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 880 2869    0    0    0]
 [  63    0 1023   72    0]
 [  35    0   17  555    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3924    2    0    1    0]
 [  67 3682    0    0    0]
 [  25    0 1036   97    0]
 [  32    0   16  559    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 789 2960    0    0    0]
 [  39    0 1043   76    0]
 [  32    0   16  559    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 319 3430    0    0    0]
 [  22    0 1036  100    0]
 [  27    0   15  565    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 838 2911    0    0    0]
 [  50    0 1038   70    0]
 [  34    0   19  554    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3925    1    0    1    0]
 [ 120 3629    0    0    0]
 [  17    0 1054   87    0]
 [   8    0   17  582    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 913 2836    0    0    0]
 [  72    0 1062   24    0]
 [  51    0   49  507    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 104 3645    0    0    0]
 [  57    0 1027   74    0]
 [  33    0   19  555    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 898 2851    0    0    0]
 [  49    0 1044   65    0]
 [  23    0   18  566    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 100 3649    0    0    0]
 [  45    0 1078   35    0]
 [  46    0   33  528    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 548 3201    0    0    0]
 [  29    0 1047   82    0]
 [  19    0   16  572    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [1077 2672    0    0    0]
 [  32    0 1049   77    0]
 [  20    0   17  570    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [  53 3696    0    0    0]
 [  18    0 1027  113    0]
 [  16    0   12  579    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 724 3025    0    0    0]
 [  34    0 1080   44    0]
 [  21    0   26  560    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 267 3482    0    0    0]
 [  70    0 1042   46    0]
 [  31    0   20  556    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 835 2914    0    0    0]
 [  35    0 1064   59    0]
 [  36    0   20  551    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 141 3608    0    0    0]
 [  20    0 1086   52    0]
 [  20    0   20  567    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 674 3075    0    0    0]
 [  24    0 1060   74    0]
 [  18    0   17  572    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [1049 2700    0    0    0]
 [  66    0 1047   45    0]
 [  44    0   20  543    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [  56 3693    0    0    0]
 [  21    0 1067   70    0]
 [  31    0   17  559    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 494 3255    0    0    0]
 [  22    0 1078   58    0]
 [  15    0   18  574    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 141 3608    0    0    0]
 [  18    0 1057   83    0]
 [  10    0   15  582    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 715 3034    0    0    0]
 [  31    0 1050   77    0]
 [  14    0   15  578    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [  91 3658    0    0    0]
 [  19    0 1060   79    0]
 [  18    0   16  573    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 751 2998    0    0    0]
 [  26    0 1076   56    0]
 [  17    0   19  571    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 102 3647    0    0    0]
 [  19    0 1041   98    0]
 [  15    0   12  580    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 670 3079    0    0    0]
 [  25    0 1087   46    0]
 [  18    0   21  568    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 494 3255    0    0    0]
 [  32    0 1087   39    0]
 [  28    0   22  557    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 456 3293    0    0    0]
 [  39    0 1072   47    0]
 [  34    0   19  554    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 495 3254    0    0    0]
 [  20    0 1059   79    0]
 [   9    0   15  583    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [  52 3697    0    0    0]
 [  26    0 1069   63    0]
 [  28    0   17  562    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 542 3207    0    0    0]
 [  14    0 1076   68    0]
 [   9    0   15  583    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 127 3622    0    0    0]
 [  13    0 1066   79    0]
 [   5    0   14  588    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 411 3338    0    0    0]
 [  24    0 1079   55    0]
 [  11    0   17  579    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 597 3152    0    0    0]
 [  16    0 1063   79    0]
 [   9    0   14  584    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 382 3367    0    0    0]
 [  21    0 1063   74    0]
 [  16    0   15  576    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 797 2952    0    0    0]
 [  12    0 1067   79    0]
 [   9    0   14  584    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 801 2948    0    0    0]
 [  29    0 1080   49    0]
 [  23    0   20  564    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 271 3478    0    0    0]
 [  26    0 1072   60    0]
 [  14    0   17  576    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 576 3173    0    0    0]
 [  10    0 1083   65    0]
 [   6    0   17  584    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [  88 3661    0    0    0]
 [  35    0 1078   45    0]
 [  29    0   22  556    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 850 2899    0    0    0]
 [   8    0 1098   52    0]
 [   5    0   21  581    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [  42 3707    0    0    0]
 [  13    0 1054   91    0]
 [   4    0   12  591    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 866 2883    0    0    0]
 [  34    0 1094   30    0]
 [  24    0   33  550    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 204 3545    0    0    0]
 [  22    0 1085   51    0]
 [  13    0   17  577    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 701 3048    0    0    0]
 [  10    0 1083   65    0]
 [   4    0   17  586    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 665 3084    0    0    0]
 [  14    0 1068   76    0]
 [   6    0   16  585    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 614 3135    0    0    0]
 [   8    0 1098   52    0]
 [   4    0   20  583    0]
 [   0    0    0    0  165]]
cf matrix for slice :5
[[3926    0    0    1    0]
 [ 614 3135    0    0    0]
 [   8    0 1098   52    0]
 [   4    0   20  583    0]
 [   0    0    0    0  165]]